<div class="container">
  <h4 class="header">Ingresos de mercaderías</h4>
  <div class="card horizontal">
    <div class="card-stacked">
      <div class="card-content">
        <form [formGroup]="formularioForm">
          <div class="row">          
            <!-- Loop para generar los inputs dinámicamente -->
            <div *ngFor="let input of inputs" class="col-md-6 col-lg-4 mb-3"> <!-- Aquí aplicamos grid de Bootstrap -->

              <!-- Date formulario -->
              <div *ngIf="input.type === 'date'" class="input-field {{ input.visible }}">
                <i class="material-symbols-outlined prefix">{{ input.icon }}</i>
                <input type="text" class="datepicker" [id]="input.id" #datePicker [pattern]="input.pattern">
                <label for="{{ input.id }}">{{ input.label }}</label>
              </div>

              <!-- Datetime formulario -->
              <div *ngIf="input.type === 'datetime'" class="input-field {{ input.visible }}">
                <i class="material-symbols-outlined prefix">{{ input.icon }}</i>
                <input type="text" class="datetimepicker" [id]="input.id" #datetimePicker [pattern]="input.pattern">
                <label for="{{ input.id }}">{{ input.label }}</label>
              </div>

              <!-- Input text formulario -->
              <div *ngIf="input.type === 'text'" class="input-field {{ input.visible }}">
                <i class="material-symbols-outlined prefix">{{ input.icon }}</i>
                <input [id]="input.id" type="{{ input.type }}" class="validate" [formControlName]="input.tag"
                  [required]="input.required" [pattern]="input.pattern" [(ngModel)]="input.value_default">
                <label *ngIf="input.value_default === null" [for]="input.id">{{ input.label }}</label>
                <label
                  *ngIf="formularioForm.get(input.tag)?.invalid && (formularioForm.get(input.tag)?.dirty || formularioForm.get(input.tag)?.touched)"
                  [for]="input.id" class="red-text">{{ input.label }} inválido</label>
              </div>

              <!-- Select del formulario -->
              <div *ngIf="input.type === 'select'" class="input-field {{ input.visible }}">
                <select [id]="input.id" (change)="action_id_client()" [attr.disabled]="input.disabled ? true : null"
                  [formControlName]="input.tag">
                  <option value="" disabled selected>Seleccione {{ input.label }}</option>
                  <option *ngFor="let option of input.options_view_kimbo" [value]="option.textValue">{{
                    option.textValue }}</option>
                </select>
                <label for="{{ input.id }}">{{ input.label }}</label>
                <label
                  *ngIf="formularioForm.get(input.tag)?.invalid && (formularioForm.get(input.tag)?.dirty || formularioForm.get(input.tag)?.touched)"
                  [for]="input.id" class="red-text">{{ input.label }} inválido</label>
              </div>

              <!-- TextArea del formulario -->
              <div *ngIf="input.type === 'text_area'" class="input-field {{ input.visible }}">
                <i class="material-symbols-outlined prefix">{{ input.icon }}</i>
                <textarea [id]="input.id" class="materialize-textarea" [formControlName]="input.tag"></textarea>
                <label for="{{ input.id }}">{{ input.label }}</label>
                <label
                  *ngIf="formularioForm.get(input.tag)?.invalid && (formularioForm.get(input.tag)?.dirty || formularioForm.get(input.tag)?.touched)"
                  [for]="input.id" class="red-text">{{ input.label }} inválido</label>
              </div>

            </div>
            <div class="d-flex justify-content-center" *ngIf="isSuccessAlert">
              <div id="toast-success" class="toast align-items-center bg-white border-0 mb-4 fade show shadow-sm" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="d-flex">
                  <div class="toast-body d-flex align-items-center text-body">
                    <div class="bg-success bg-opacity-10 text-success rounded-circle d-flex align-items-center justify-content-center" style="width: 32px; height: 32px;">
                      <svg class="bi" width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
                      </svg>
                    </div>
                    <div class="ms-3">Transacción exitosa.</div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
        </form>
      </div>
      <div class="card-action center-align">
        <button class="btn waves-effect waves-light" type="submit" (click)="aplicarNewIng()" name="action">Guardar
          Transacción
          <i class="material-symbols-outlined right">send</i>
        </button>
      </div>
      <div *ngIf="isLoading" class="position-fixed top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center bg-light bg-opacity-75 custom-overlay">
        <div class="text-center">
          <app-hear-loading></app-hear-loading>
          <app-three-js-animation></app-three-js-animation>
        </div>
      </div>
            

    </div>
  </div>
</div>